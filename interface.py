import os  # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –º–æ–¥—É–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π
from datetime import datetime  # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∫–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞—Ç–æ–π –∏ –≤—Ä–µ–º–µ–Ω–µ–º
from modules.text_extractor import TextExtractor  # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∫–ª–∞—Å—Å –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –∏–∑ —Ñ–∞–π–ª–æ–≤
from modules.text_cleaner import TextCleaner  # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∫–ª–∞—Å—Å –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ —Ç–µ–∫—Å—Ç–∞
from modules.ai_processor import AIProcessor  # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∫–ª–∞—Å—Å –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ–∫—Å—Ç–∞ —á–µ—Ä–µ–∑ –ò–ò
from modules.data_saver import DataSaver  # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∫–ª–∞—Å—Å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
import time  # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –º–æ–¥—É–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
from colorama import init, Fore, Back, Style  # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–ª—è —Ü–≤–µ—Ç–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞ –≤ –∫–æ–Ω—Å–æ–ª—å
from tqdm import tqdm  # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–æ–≤
from modules.metrics import load_reference_terms, evaluate_terms

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è colorama –¥–ª—è Windows
init()  # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫—É colorama –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –≤ Windows

class Colors:  # –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–ª–∞—Å—Å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ü–≤–µ—Ç–æ–≤—ã—Ö –∫–æ–Ω—Å—Ç–∞–Ω—Ç
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ü–≤–µ—Ç–∞ –∏–∑ –ø–∞–ª–∏—Ç—Ä—ã –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è
    ORANGE = '\033[38;2;249;99;59m'   # #F9633B - –æ—Ä–∞–Ω–∂–µ–≤—ã–π (–æ—Å–Ω–æ–≤–Ω–æ–π –∞–∫—Ü–µ–Ω—Ç–Ω—ã–π —Ü–≤–µ—Ç)
    GRAY = '\033[38;2;129;131;125m'   # #81837d - —Å–µ—Ä—ã–π (–≤—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–π —Ü–≤–µ—Ç)
    WHITE = '\033[38;2;255;255;255m'  # #FFFFFF - –±–µ–ª—ã–π
    BLACK = '\033[38;2;33;31;31m'     # #211F1F - –ø–æ—á—Ç–∏ —á–µ—Ä–Ω—ã–π
    
    # –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ü–≤–µ—Ç–∞ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –Ω–æ–≤–æ–π –ø–∞–ª–∏—Ç—Ä–æ–π
    HEADER = ORANGE  # –¶–≤–µ—Ç –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ - –æ—Ä–∞–Ω–∂–µ–≤—ã–π
    PRIMARY = GRAY  # –û—Å–Ω–æ–≤–Ω–æ–π —Ü–≤–µ—Ç - —Å–µ—Ä—ã–π
    SUCCESS = ORANGE  # –¶–≤–µ—Ç —É—Å–ø–µ—à–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π - –æ—Ä–∞–Ω–∂–µ–≤—ã–π
    WARNING = GRAY  # –¶–≤–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π - —Å–µ—Ä—ã–π
    ERROR = ORANGE  # –¶–≤–µ—Ç –æ—à–∏–±–æ–∫ - –æ—Ä–∞–Ω–∂–µ–≤—ã–π
    INFO = WHITE  # –¶–≤–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π - –±–µ–ª—ã–π
    RESET = Style.RESET_ALL  # –°–±—Ä–æ—Å –≤—Å–µ—Ö —Ü–≤–µ—Ç–æ–≤—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
    
class Interface:  # –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã
    def __init__(self):  # –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∫–ª–∞—Å—Å–∞
        self.cleaner = TextCleaner()  # –°–æ–∑–¥–∞–µ—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä –æ—á–∏—Å—Ç–∏—Ç–µ–ª—è —Ç–µ–∫—Å—Ç–∞
        self.extractor = TextExtractor(self.cleaner)  # –°–æ–∑–¥–∞–µ—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä –∏–∑–≤–ª–µ–∫–∞—Ç–µ–ª—è —Ç–µ–∫—Å—Ç–∞, –ø–µ—Ä–µ–¥–∞–≤–∞—è –æ—á–∏—Å—Ç–∏—Ç–µ–ª—å
        self.ai_processor = AIProcessor()  # –°–æ–∑–¥–∞–µ—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –ò–ò
        self.data_saver = DataSaver()  # –°–æ–∑–¥–∞–µ—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª—è –¥–∞–Ω–Ω—ã—Ö
        self.supported_formats = ('.pdf', '.doc', '.docx')  # –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã —Ñ–∞–π–ª–æ–≤
        
    def show_logo(self):  # –ú–µ—Ç–æ–¥ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ª–æ–≥–æ—Ç–∏–ø–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã
        logo = """
    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïóüöÅ
    ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïùüöÅ
    ‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó     ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïî‚ñà‚ñà‚ñà‚ñà‚ïî‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚úàÔ∏è
    ‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù     ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù  ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë‚ïö‚ïê‚ïê‚ïê‚ïê‚ñà‚ñà‚ïë‚úàÔ∏è
    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë ‚ïö‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë ‚ïö‚ïê‚ïù ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚úàÔ∏é
    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù   ‚ïö‚ïê‚ïù   ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù     ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚úàÔ∏é
                                                       
    """  # ASCII-–∞—Ä—Ç –ª–æ–≥–æ—Ç–∏–ø –ø—Ä–æ–≥—Ä–∞–º–º—ã —Å –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–º —Å–∞–º–æ–ª–µ—Ç–∏–∫–æ–º
        print(f"{Colors.ORANGE}{logo}{Colors.RESET}")  # –í—ã–≤–æ–¥–∏—Ç –ª–æ–≥–æ—Ç–∏–ø –æ—Ä–∞–Ω–∂–µ–≤—ã–º —Ü–≤–µ—Ç–æ–º
        print(f'{Colors.WHITE}DroneTerms AI - –°–∏—Å—Ç–µ–º–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ —Ä—É—Å—Å–∫–æ-–∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ –≥–ª–æ—Å—Å–∞—Ä–∏—è –ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ "–ë–µ—Å–ø–∏–ª–æ—Ç–Ω—ã–µ –∞–≤–∏–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã"{Colors.RESET}')  # –í—ã–≤–æ–¥–∏—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã
        print(f"{Colors.GRAY}–í–µ—Ä—Å–∏—è 1.0 | {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}{Colors.RESET}")  # –í—ã–≤–æ–¥–∏—Ç –≤–µ—Ä—Å–∏—é –∏ —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É/–≤—Ä–µ–º—è —Å–µ—Ä—ã–º —Ü–≤–µ—Ç–æ–º
        print(f"{Colors.ORANGE}{'='*80}{Colors.RESET}")  # –í—ã–≤–æ–¥–∏—Ç —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å–Ω—É—é –ª–∏–Ω–∏—é –æ—Ä–∞–Ω–∂–µ–≤—ã–º —Ü–≤–µ—Ç–æ–º
        
    def show_progress(self, description, seconds):  # –ú–µ—Ç–æ–¥ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞
        for _ in tqdm(range(100), desc=description, bar_format="{l_bar}{bar}| {n_fmt}/{total_fmt}", colour="#F9633B"):  # –°–æ–∑–¥–∞–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä —Å 100 —à–∞–≥–∞–º–∏ –∏ –æ—Ä–∞–Ω–∂–µ–≤—ã–º —Ü–≤–µ—Ç–æ–º
            time.sleep(seconds/100)  # –ó–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞ (–æ–±—â–µ–µ –≤—Ä–µ–º—è = seconds)

    def display_terms(self, ai_response):  # –ú–µ—Ç–æ–¥ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Ç–µ—Ä–º–∏–Ω–æ–≤
        print(f"\n{Colors.HEADER}–ù–∞–π–¥–µ–Ω–Ω—ã–µ —Ç–µ—Ä–º–∏–Ω—ã:{Colors.RESET}")  # –í—ã–≤–æ–¥–∏—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ –æ—Ä–∞–Ω–∂–µ–≤—ã–º
        print(f"{Colors.ORANGE}{'='*80}{Colors.RESET}")  # –í—ã–≤–æ–¥–∏—Ç —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å–Ω—É—é –ª–∏–Ω–∏—é –æ—Ä–∞–Ω–∂–µ–≤—ã–º
        print(f"{Colors.WHITE}{ai_response}{Colors.RESET}")  # –í—ã–≤–æ–¥–∏—Ç –æ—Ç–≤–µ—Ç –ò–ò —Å —Ç–µ—Ä–º–∏–Ω–∞–º–∏ –±–µ–ª—ã–º
        print(f"{Colors.ORANGE}{'='*80}{Colors.RESET}")  # –í—ã–≤–æ–¥–∏—Ç —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å–Ω—É—é –ª–∏–Ω–∏—é –æ—Ä–∞–Ω–∂–µ–≤—ã–º

    def process_file(self, file_path):  # –ú–µ—Ç–æ–¥ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∞–π–ª–∞
        print(f"\n{Colors.HEADER}–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞:{Colors.RESET} {file_path}")  # –í—ã–≤–æ–¥–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–∞–π–ª–µ
        print(f"{Colors.ORANGE}{'='*80}{Colors.RESET}")  # –í—ã–≤–æ–¥–∏—Ç —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å–Ω—É—é –ª–∏–Ω–∏—é –æ—Ä–∞–Ω–∂–µ–≤—ã–º

        # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
        print(f"\n{Colors.WHITE}–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∏–∑ —Ñ–∞–π–ª–∞...{Colors.RESET}")  # –°–æ–æ–±—â–µ–Ω–∏–µ –æ –Ω–∞—á–∞–ª–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞
        self.show_progress("–ß—Ç–µ–Ω–∏–µ —Ñ–∞–π–ª–∞", 1)  # –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞ (1 —Å–µ–∫—É–Ω–¥–∞)
        original_text = self.extractor.extract_raw_text(file_path)  # –ò–∑–≤–ª–µ–∫–∞–µ—Ç —Ç–µ–∫—Å—Ç –∏–∑ —Ñ–∞–π–ª–∞
        
        if not original_text:  # –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —É—Å–ø–µ—à–Ω–æ –ª–∏ –∏–∑–≤–ª–µ—á–µ–Ω —Ç–µ–∫—Å—Ç
            print(f"{Colors.ERROR}–û—à–∏–±–∫–∞: –ù–µ —É–¥–∞–ª–æ—Å—å –∏–∑–≤–ª–µ—á—å —Ç–µ–∫—Å—Ç –∏–∑ —Ñ–∞–π–ª–∞{Colors.RESET}")  # –í—ã–≤–æ–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
            return False  # –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç False –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏

        original_length = len(original_text)  # –í—ã—á–∏—Å–ª—è–µ—Ç –¥–ª–∏–Ω—É –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
        print(f"\n{Colors.ORANGE}–£—Å–ø–µ—à–Ω–æ –∏–∑–≤–ª–µ—á–µ–Ω–æ —Å–∏–º–≤–æ–ª–æ–≤: {original_length}{Colors.RESET}")  # –í—ã–≤–æ–¥–∏—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ –æ—Ä–∞–Ω–∂–µ–≤—ã–º

        # –í—ã–≤–æ–¥ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
        print(f"\n{Colors.HEADER}–ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç:{Colors.RESET}")  # –ó–∞–≥–æ–ª–æ–≤–æ–∫ –¥–ª—è –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
        print(f"{Colors.GRAY}{'-'*80}{Colors.RESET}")  # –í—ã–≤–æ–¥–∏—Ç —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å–Ω—É—é –ª–∏–Ω–∏—é —Å–µ—Ä—ã–º
        print(f"{Colors.GRAY}{original_text[:500]}...{Colors.RESET}")  # –í—ã–≤–æ–¥–∏—Ç –ø–µ—Ä–≤—ã–µ 500 —Å–∏–º–≤–æ–ª–æ–≤ —Ç–µ–∫—Å—Ç–∞ —Å–µ—Ä—ã–º
        print(f"{Colors.WHITE}(–ü–æ–∫–∞–∑–∞–Ω—ã –ø–µ—Ä–≤—ã–µ 500 —Å–∏–º–≤–æ–ª–æ–≤){Colors.RESET}")  # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–µ–ª—ã–º
        print(f"{Colors.GRAY}{'-'*80}{Colors.RESET}")  # –í—ã–≤–æ–¥–∏—Ç —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å–Ω—É—é –ª–∏–Ω–∏—é —Å–µ—Ä—ã–º

        # –û—á–∏—Å—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞
        print(f"\n{Colors.WHITE}–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ—á–∏—Å—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞...{Colors.RESET}")  # –°–æ–æ–±—â–µ–Ω–∏–µ –æ –Ω–∞—á–∞–ª–µ –æ—á–∏—Å—Ç–∫–∏ —Ç–µ–∫—Å—Ç–∞
        self.show_progress("–û—á–∏—Å—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞", 1)  # –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –æ—á–∏—Å—Ç–∫–∏ —Ç–µ–∫—Å—Ç–∞ (1 —Å–µ–∫—É–Ω–¥–∞)
        cleaned_text = self.extractor.cleaner.clean_and_log(original_text)  # –û—á–∏—â–∞–µ—Ç —Ç–µ–∫—Å—Ç

        if not cleaned_text:  # –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —É—Å–ø–µ—à–Ω–æ –ª–∏ –æ—á–∏—â–µ–Ω —Ç–µ–∫—Å—Ç
            print(f"{Colors.ERROR}–û—à–∏–±–∫–∞: –ù–µ —É–¥–∞–ª–æ—Å—å –æ—á–∏—Å—Ç–∏—Ç—å —Ç–µ–∫—Å—Ç{Colors.RESET}")  # –í—ã–≤–æ–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
            return False  # –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç False –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏

        cleaned_length = len(cleaned_text)  # –í—ã—á–∏—Å–ª—è–µ—Ç –¥–ª–∏–Ω—É –æ—á–∏—â–µ–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
        reduction = ((original_length - cleaned_length) / original_length) * 100  # –í—ã—á–∏—Å–ª—è–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞

        print(f"\n{Colors.ORANGE}–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—á–∏—Å—Ç–∫–∏:{Colors.RESET}")  # –ó–∞–≥–æ–ª–æ–≤–æ–∫ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –æ—Ä–∞–Ω–∂–µ–≤—ã–º
        print(f"{Colors.WHITE}–ò—Å—Ö–æ–¥–Ω—ã–π —Ä–∞–∑–º–µ—Ä: {original_length} —Å–∏–º–≤–æ–ª–æ–≤{Colors.RESET}")  # –í—ã–≤–æ–¥–∏—Ç –∏—Å—Ö–æ–¥–Ω—ã–π —Ä–∞–∑–º–µ—Ä –±–µ–ª—ã–º
        print(f"{Colors.WHITE}–ü–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏: {cleaned_length} —Å–∏–º–≤–æ–ª–æ–≤{Colors.RESET}")  # –í—ã–≤–æ–¥–∏—Ç —Ä–∞–∑–º–µ—Ä –ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏ –±–µ–ª—ã–º
        print(f"{Colors.WHITE}–°–æ–∫—Ä–∞—â–µ–Ω–∏–µ: {reduction:.1f}%{Colors.RESET}")  # –í—ã–≤–æ–¥–∏—Ç –ø—Ä–æ—Ü–µ–Ω—Ç —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è –±–µ–ª—ã–º

        # –í—ã–≤–æ–¥ –æ—á–∏—â–µ–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
        print(f"\n{Colors.HEADER}–û—á–∏—â–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç:{Colors.RESET}")  # –ó–∞–≥–æ–ª–æ–≤–æ–∫ –¥–ª—è –æ—á–∏—â–µ–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –æ—Ä–∞–Ω–∂–µ–≤—ã–º
        print(f"{Colors.GRAY}{'-'*80}{Colors.RESET}")  # –í—ã–≤–æ–¥–∏—Ç —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å–Ω—É—é –ª–∏–Ω–∏—é —Å–µ—Ä—ã–º
        print(f"{Colors.ORANGE}{cleaned_text[:500]}...{Colors.RESET}")  # –í—ã–≤–æ–¥–∏—Ç –ø–µ—Ä–≤—ã–µ 500 —Å–∏–º–≤–æ–ª–æ–≤ –æ—á–∏—â–µ–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –æ—Ä–∞–Ω–∂–µ–≤—ã–º
        print(f"{Colors.WHITE}(–ü–æ–∫–∞–∑–∞–Ω—ã –ø–µ—Ä–≤—ã–µ 500 —Å–∏–º–≤–æ–ª–æ–≤){Colors.RESET}")  # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–µ–ª—ã–º
        print(f"{Colors.GRAY}{'-'*80}{Colors.RESET}")  # –í—ã–≤–æ–¥–∏—Ç —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å–Ω—É—é –ª–∏–Ω–∏—é —Å–µ—Ä—ã–º

        filename = os.path.basename(file_path)  # –ò–∑–≤–ª–µ–∫–∞–µ—Ç –∏–º—è —Ñ–∞–π–ª–∞ –∏–∑ –ø—É—Ç–∏

        # –û–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ –ò–ò
        while True:  # –¶–∏–∫–ª –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            ai_choice = input(f"\n{Colors.WHITE}–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É —á–µ—Ä–µ–∑ –ò–ò? (–¥–∞/–Ω–µ—Ç): {Colors.RESET}").lower()  # –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –≤—ã–±–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            if ai_choice in ['–¥–∞', '–Ω–µ—Ç']:  # –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –≤–≤–æ–¥–∞
                break  # –í—ã—Ö–æ–¥–∏—Ç –∏–∑ —Ü–∏–∫–ª–∞, –µ—Å–ª–∏ –≤–≤–æ–¥ –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω
            print(f"{Colors.GRAY}–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ '–¥–∞' –∏–ª–∏ '–Ω–µ—Ç'{Colors.RESET}")  # –í—ã–≤–æ–¥–∏—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–º –≤–≤–æ–¥–µ —Å–µ—Ä—ã–º

        if ai_choice == '–¥–∞':  # –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±—Ä–∞–ª –æ–±—Ä–∞–±–æ—Ç–∫—É —á–µ—Ä–µ–∑ –ò–ò
            print(f"\n{Colors.WHITE}–û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ–∫—Å—Ç–∞ –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É —á–µ—Ä–µ–∑ –ò–ò...{Colors.RESET}")  # –°–æ–æ–±—â–µ–Ω–∏–µ –æ –Ω–∞—á–∞–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏
            self.ai_processor.model_name = None  # –°–±—Ä–∞—Å—ã–≤–∞–µ—Ç –∏–º—è –º–æ–¥–µ–ª–∏ –ò–ò –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            result = self.ai_processor.process_text(cleaned_text)  # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–µ–∫—Å—Ç —á–µ—Ä–µ–∑ –ò–ò
            
            if result == "return_to_main":  # –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ñ–ª–∞–≥ –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
                return "return_to_main"  # –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ñ–ª–∞–≥
            
            if not result:  # –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —É—Å–ø–µ—à–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏
                print(f"{Colors.ERROR}–û—à–∏–±–∫–∞: –ù–µ —É–¥–∞–ª–æ—Å—å –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ç–µ–∫—Å—Ç —á–µ—Ä–µ–∑ –ò–ò{Colors.RESET}")  # –í—ã–≤–æ–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
                return False  # –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç False –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏

            self.display_terms(result)  # –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —Ç–µ—Ä–º–∏–Ω—ã

            # --- –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ç–µ—Ä–º–∏–Ω–æ–≤ ---
            parsed_terms = [t['—Ç–µ—Ä–º–∏–Ω'] for t in self.data_saver.parse_ai_terms(result) if '—Ç–µ—Ä–º–∏–Ω' in t]
            reference_terms = load_reference_terms(filename)
            if reference_terms:
                precision, recall, f1 = evaluate_terms(parsed_terms, reference_terms)
                print(f"\n{Colors.HEADER}–ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ç–µ—Ä–º–∏–Ω–æ–≤:{Colors.RESET}")
                print(f"{Colors.ORANGE}Precision: {precision:.2f}{Colors.RESET}")
                print(f"{Colors.ORANGE}Recall:    {recall:.2f}{Colors.RESET}")
                print(f"{Colors.ORANGE}F1-score:  {f1:.2f}{Colors.RESET}")
                print(f"{Colors.ORANGE}{'='*80}{Colors.RESET}")
            else:
                print(f"{Colors.GRAY}–≠—Ç–∞–ª–æ–Ω–Ω—ã–π —Ñ–∞–π–ª —Ç–µ—Ä–º–∏–Ω–æ–≤ –¥–ª—è —ç—Ç–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω. –ú–µ—Ç—Ä–∏–∫–∏ –Ω–µ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω—ã.{Colors.RESET}")

            while True:  # –¶–∏–∫–ª –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏
                save_choice = input(f"\n{Colors.WHITE}–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã? (–¥–∞/–Ω–µ—Ç): {Colors.RESET}").lower()  # –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –≤—ã–±–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                if save_choice in ['–¥–∞', '–Ω–µ—Ç']:  # –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –≤–≤–æ–¥–∞
                    break  # –í—ã—Ö–æ–¥–∏—Ç –∏–∑ —Ü–∏–∫–ª–∞, –µ—Å–ª–∏ –≤–≤–æ–¥ –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω
                print(f"{Colors.GRAY}–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ '–¥–∞' –∏–ª–∏ '–Ω–µ—Ç'{Colors.RESET}")  # –í—ã–≤–æ–¥–∏—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–º –≤–≤–æ–¥–µ —Å–µ—Ä—ã–º

        if save_choice == '–¥–∞':
            print(f"\n{Colors.WHITE}–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤...{Colors.RESET}")
            self.show_progress("–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ", 1)

            # --- –î–æ–±–∞–≤–ª–µ–Ω–æ: —Å–æ—Ö—Ä–∞–Ω—è–µ–º –º–µ—Ç—Ä–∏–∫–∏, –µ—Å–ª–∏ –æ–Ω–∏ —Å—á–∏—Ç–∞–ª–∏—Å—å ---
            metrics_dict = None
            if reference_terms:
                metrics_dict = {
                    "Precision": f"{precision:.2f}",
                    "Recall": f"{recall:.2f}",
                    "F1-score": f"{f1:.2f}"
                }

            if not self.data_saver.save_terms(result, filename, metrics=metrics_dict):
                print(f"{Colors.GRAY}–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: –í–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ç–µ—Ä–º–∏–Ω–æ–≤{Colors.RESET}")
            else:
                print(f"{Colors.ORANGE}–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!{Colors.RESET}")
            print(f"{Colors.GRAY}{'-' * 80}{Colors.RESET}")  # –í—ã–≤–æ–¥–∏—Ç —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å–Ω—É—é –ª–∏–Ω–∏—é —Å–µ—Ä—ã–º
        else:
            print(f"\n{Colors.WHITE}–í–æ–∑–≤—Ä–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É —à–∞–≥—É...{Colors.RESET}")  # –°–æ–æ–±—â–µ–Ω–∏–µ –æ –≤–æ–∑–≤—Ä–∞—Ç–µ, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫–∞–∑–∞–ª—Å—è –æ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏

        return True  # –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç True –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏

    def show_available_files(self):  # –ú–µ—Ç–æ–¥ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
        print(f"\n{Colors.HEADER}–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫–µ data:{Colors.RESET}")  # –ó–∞–≥–æ–ª–æ–≤–æ–∫ –¥–ª—è —Å–ø–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤ –æ—Ä–∞–Ω–∂–µ–≤—ã–º
        print(f"{Colors.GRAY}{'-' * 80}{Colors.RESET}")  # –í—ã–≤–æ–¥–∏—Ç —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å–Ω—É—é –ª–∏–Ω–∏—é —Å–µ—Ä—ã–º
        
        data_folder = 'data'  # –ò–º—è –ø–∞–ø–∫–∏ —Å –¥–∞–Ω–Ω—ã–º–∏
        if not os.path.exists(data_folder):  # –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –ø–∞–ø–∫–∏
            print(f"{Colors.ERROR}–ü–∞–ø–∫–∞ 'data' –Ω–µ –Ω–∞–π–¥–µ–Ω–∞{Colors.RESET}")  # –í—ã–≤–æ–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
            return []  # –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫, –µ—Å–ª–∏ –ø–∞–ø–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞

        files = []  # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å–ø–∏—Å–æ–∫ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–º–µ–Ω —Ñ–∞–π–ª–æ–≤
        for file in os.listdir(data_folder):  # –ü–µ—Ä–µ–±–∏—Ä–∞–µ—Ç –≤—Å–µ —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫–µ
            if file.lower().endswith(self.supported_formats):  # –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –∏–º–µ–µ—Ç –ª–∏ —Ñ–∞–π–ª –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç
                files.append(file)  # –î–æ–±–∞–≤–ª—è–µ—Ç —Ñ–∞–π–ª –≤ —Å–ø–∏—Å–æ–∫
                print(f"{Colors.ORANGE}{len(files)}. {file}{Colors.RESET}")  # –í—ã–≤–æ–¥–∏—Ç –Ω–æ–º–µ—Ä –∏ –∏–º—è —Ñ–∞–π–ª–∞ –æ—Ä–∞–Ω–∂–µ–≤—ã–º
        
        if not files:  # –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –Ω–∞–π–¥–µ–Ω—ã –ª–∏ —Ñ–∞–π–ª—ã
            print(f"{Colors.GRAY}–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤{Colors.RESET}")  # –í—ã–≤–æ–¥–∏—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ —Å–µ—Ä—ã–º
        
        print(f"{Colors.GRAY}{'-' * 80}{Colors.RESET}")  # –í—ã–≤–æ–¥–∏—Ç —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å–Ω—É—é –ª–∏–Ω–∏—é —Å–µ—Ä—ã–º
        return files  # –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤

    def run(self):  # –û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥ –∑–∞–ø—É—Å–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        while True:  # –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª –¥–ª—è —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã
            os.system('cls' if os.name == 'nt' else 'clear')  # –û—á–∏—â–∞–µ—Ç –∫–æ–Ω—Å–æ–ª—å (cls –¥–ª—è Windows, clear –¥–ª—è Unix)
            self.show_logo()  # –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –ª–æ–≥–æ—Ç–∏–ø –ø—Ä–æ–≥—Ä–∞–º–º—ã
            
            available_files = self.show_available_files()  # –ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
            
            print(f"\n{Colors.HEADER}–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:{Colors.RESET}")  # –ó–∞–≥–æ–ª–æ–≤–æ–∫ –¥–ª—è –º–µ–Ω—é –æ—Ä–∞–Ω–∂–µ–≤—ã–º
            print(f"{Colors.ORANGE}1. –û–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ñ–∞–π–ª{Colors.RESET}")  # –ü—É–Ω–∫—Ç –º–µ–Ω—é 1 –æ—Ä–∞–Ω–∂–µ–≤—ã–º
            print(f"{Colors.ORANGE}2. –í—ã–π—Ç–∏ –∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º—ã{Colors.RESET}")  # –ü—É–Ω–∫—Ç –º–µ–Ω—é 2 –æ—Ä–∞–Ω–∂–µ–≤—ã–º
            
            choice = input(f"\n{Colors.WHITE}–í–∞—à –≤—ã–±–æ—Ä (1-2): {Colors.RESET}")  # –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –≤—ã–±–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            
            if choice == '1':  # –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞
                if available_files:  # –ï—Å–ª–∏ –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ–∞–π–ª—ã
                    file_input = input(f"\n{Colors.WHITE}–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ñ–∞–π–ª–∞ –∏–∑ —Å–ø–∏—Å–∫–∞ –≤—ã—à–µ\n–∏–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ (–∏–ª–∏ –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –∫ –¥—Ä—É–≥–æ–º—É —Ñ–∞–π–ª—É): {Colors.RESET}")  # –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –≤—ã–±–æ—Ä —Ñ–∞–π–ª–∞
                    
                    if file_input.isdigit():  # –ï—Å–ª–∏ –≤–≤–µ–¥–µ–Ω –Ω–æ–º–µ—Ä —Ñ–∞–π–ª–∞
                        file_num = int(file_input)  # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç —Å—Ç—Ä–æ–∫—É –≤ —á–∏—Å–ª–æ
                        if 1 <= file_num <= len(available_files):  # –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –Ω–æ–º–µ—Ä –≤ –¥–æ–ø—É—Å—Ç–∏–º–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ
                            file_path = os.path.join('data', available_files[file_num-1])  # –§–æ—Ä–º–∏—Ä—É–µ—Ç –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É
                        else:
                            print(f"{Colors.ERROR}\n–û—à–∏–±–∫–∞: –ù–µ–≤–µ—Ä–Ω—ã–π –Ω–æ–º–µ—Ä —Ñ–∞–π–ª–∞{Colors.RESET}")  # –í—ã–≤–æ–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
                            input(f"\n{Colors.WHITE}–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...{Colors.RESET}")  # –û–∂–∏–¥–∞–µ—Ç –Ω–∞–∂–∞—Ç–∏—è Enter
                            continue  # –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç –∫ —Å–ª–µ–¥—É—é—â–µ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ —Ü–∏–∫–ª–∞
                    else:  # –ï—Å–ª–∏ –≤–≤–µ–¥–µ–Ω–æ –∏–º—è —Ñ–∞–π–ª–∞ –∏–ª–∏ –ø—É—Ç—å
                        if file_input in available_files:  # –ï—Å–ª–∏ —Ñ–∞–π–ª –µ—Å—Ç—å –≤ —Å–ø–∏—Å–∫–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö
                            file_path = os.path.join('data', file_input)  # –§–æ—Ä–º–∏—Ä—É–µ—Ç –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –≤ –ø–∞–ø–∫–µ data
                        else:
                            file_path = file_input  # –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–≤–µ–¥–µ–Ω–Ω—ã–π –ø—É—Ç—å –∫–∞–∫ –µ—Å—Ç—å

                    if not os.path.exists(file_path):  # –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
                        print(f"{Colors.ERROR}\n–û—à–∏–±–∫–∞: –§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω{Colors.RESET}")  # –í—ã–≤–æ–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
                        input(f"\n{Colors.WHITE}–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...{Colors.RESET}")  # –û–∂–∏–¥–∞–µ—Ç –Ω–∞–∂–∞—Ç–∏—è Enter
                        continue  # –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç –∫ —Å–ª–µ–¥—É—é—â–µ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ —Ü–∏–∫–ª–∞
                        
                    result = self.process_file(file_path)  # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ñ–∞–π–ª
                    if result != "return_to_main":  # –ï—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–µ–Ω —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ñ–ª–∞–≥ –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞
                        input(f"\n{Colors.WHITE}–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...{Colors.RESET}")  # –û–∂–∏–¥–∞–µ—Ç –Ω–∞–∂–∞—Ç–∏—è Enter
                else:  # –ï—Å–ª–∏ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
                    print(f"{Colors.GRAY}\n–ü–æ–º–µ—Å—Ç–∏—Ç–µ —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫—É 'data' –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏{Colors.RESET}")  # –í—ã–≤–æ–¥–∏—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ —Å–µ—Ä—ã–º
                    input(f"\n{Colors.WHITE}–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...{Colors.RESET}")  # –û–∂–∏–¥–∞–µ—Ç –Ω–∞–∂–∞—Ç–∏—è Enter
                
            elif choice == '2':  # –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω –≤—ã—Ö–æ–¥ –∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º—ã
                print(f"\n{Colors.ORANGE}–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã...{Colors.RESET}")  # –í—ã–≤–æ–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –æ—Ä–∞–Ω–∂–µ–≤—ã–º
                break  # –í—ã—Ö–æ–¥–∏—Ç –∏–∑ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–≥–æ —Ü–∏–∫–ª–∞
            else:  # –ï—Å–ª–∏ –≤–≤–µ–¥–µ–Ω –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –≤—ã–±–æ—Ä
                print(f"{Colors.ERROR}\n–ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ 1 –∏–ª–∏ 2{Colors.RESET}")  # –í—ã–≤–æ–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
                input(f"\n{Colors.WHITE}–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...{Colors.RESET}")  # –û–∂–∏–¥–∞–µ—Ç –Ω–∞–∂–∞—Ç–∏—è Enter
